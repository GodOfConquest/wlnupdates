<!-- extend base layout -->
{% macro singleItemBlock(name, value, valId) -%}
	<div class="well well-tny info-item">
		<div class="row">
			<div class="col-md-3">
				{{ name }}:
			</div>
			<div class="col-md-9" id='{{valId}}'>
				{{ ( value if value else "N/A" ) | safe }}
			</div>
		</div>
	</div>
{%- endmacro %}


{% macro multiItemBlock(name, inList, itemKey, valId) -%}
	<div class="well well-tny info-item">
		<div class="row">
			<div class="col-md-3">
				{{ name }}:
			</div>
			<div class="col-md-9">
				{% for item in inList %}
				<span id='{{valId}}'>{{ item[itemKey] }}</span>,
				{% else %}
					<span id='{{valId}}'>N/A</span>
				{% endfor %}

			</div>
		</div>
	</div>
{%- endmacro %}

{% macro coversBlock(covers) -%}

	{% if covers %}
		<div class='imgDiv'>
			{% for cover in covers %}
				<div id="cover-item" style="display: none;">
					<img src='/cover-img/{{ cover.id }}'>
					{% if cover.description %}
						<h4>{{cover.description}}</h4>
					{% else %}
						<h5>No Description</h5>
					{% endif %}

				</div>
			{% endfor %}
		<p id='cover-offset' style=""></p>

		</div>
	{% else %}
		<style>

			#x{
/*			    width: 20px;
				height: 20px;*/
				/*background-color:orange;*/
				position:relative;
				border-radius:2px;
			}
			#x::after,#x::before{
				position:absolute;
				top:200px;
				left:0px;
				content:'';
				display:block;
				width:400px;
				height:10px;
				background-color:red;

			}
			#x::after{
				-webkit-transform: rotate(45deg);
				-moz-transform: rotate(45deg);
				-ms-transform: rotate(45deg);
				-o-transform: rotate(45deg);
				transform: rotate(45deg);
			}
			#x::before{
				-webkit-transform: rotate(-45deg);
				-moz-transform: rotate(-45deg);
				-ms-transform: rotate(-45deg);
				-o-transform: rotate(-45deg);
				transform: rotate(-45deg);
			}
			#x-content {
				width: 400px;
				text-align: center !important ;
			}
			#x-desc-div {
				position: absolute;
				bottom: 0;
				margin-right:auto;
				margin-left:auto;
			}

		</style>
		<div class='imgDiv' id='x'>
			<div id='x-desc-div'>
				<p id='x-content'>No covers! Add one, maybe?</p>
			</div>
		</div>
	{% endif %}
	<script>

		var pos_text = $('p[id="cover-offset"]');
		var divs = $('div[id="cover-item"]');
		if (divs.length == 1)
		{
			console.log("Divs:", divs)
			console.log("ThisDiv:", divs.eq(0))
			divs.eq(0).fadeIn(400);
		}
		else if (divs.length > 1)
		{
			divs.hide();
			var i = 0;

			(function cycle() {
				divs.eq(i).fadeIn(400)
						  .delay(5000)
						  .fadeOut(400, cycle);

				i = ++i % divs.length;

				pos_text.html("Cover " + (i+1) + " of " + divs.length);


			})();
		}
		else
		{
			// No images?
		}
	</script>
{%- endmacro %}


{% extends "base.html" %}

{% block content %}
	{% include 'flash.html' %}

	<style type="text/css">
		<!--
			@media (min-width: 768px)
			{
				.imgDiv {
					height     : 600px !important;
					width      : 400px !important;
					max-height : 600px !important;
					max-width  : 400px !important;
					float      : right;

					display: inline-block;
					margin-left: 10px;
					padding-top: 10px;
				}
				.info-item
				{
					overflow : hidden;
				}
			}

			@media (max-width: 767px)
			{
				.imgDiv {
					display: block;
					height     : 400px !important;

				}
				.info-item
				{
					/*overflow : hidden;*/
				}
			}
			.imgDiv
			{
				border: 2px solid #000;
				vertical-align : middle;
				text-align: center;
			}
		-->
	</style>

	<div class="well well-large">
		<h2>{{ series.title }}</h2>


			{{coversBlock(covers)}}

			{{singleItemBlock("Description",       series.description, 'description'     )}}
			{{singleItemBlock("Demographic",       series.demographic, 'demographic'     )}}
			{{singleItemBlock("Type",              series.type,        'type'            )}}
			{{singleItemBlock("Country of Origin", series.origin_loc,  'origin_loc'      )}}
			{{singleItemBlock("Original Language", series.orig_lang,   'orig_lang'       )}}

			{{multiItemBlock("Author(s)",          author,             'author', 'author')}}
			{{multiItemBlock("Illustrator(s)",     illustrators,       'name',   'illustrators')}}

			{{multiItemBlock("Tags",     tags,               'tag',    'tag')}}
			{{multiItemBlock("Genres",     genres,               'genre',    'genre')}}

			<div style="clear: both;"></div>

	</div>

	</ul>
{% endblock %}
